{% extends "base.html" %}
{% block content %}
<h2>ğŸ“š Resources</h2>
<form method="get" class="filters">
  <select name="subject">
    <option value="">All Subjects</option>
    {% for s in subjects %}
    <option value="{{ s }}" {% if request.args.get('subject')==s %}selected{% endif %}>{{ s }}</option>
    {% endfor %}
  </select>
  <select name="difficulty">
    <option value="">Any Difficulty</option>
    {% for d in ['easy','medium','hard'] %}
      <option value="{{ d }}" {% if request.args.get('difficulty')==d %}selected{% endif %}>{{ d|capitalize }}</option>
    {% endfor %}
  </select>
  <button class="btn" type="submit">ğŸ” Filter</button>
</form>
<div class="list">
  {% for r in items %}
  <div class="item">
    <div style="display: flex; align-items: center; gap: 12px;">
      {% if r.resource_type == 'youtube' %}
        <span style="font-size: 1.5rem;">ğŸ“º</span>
      {% elif r.resource_type == 'pdf' %}
        <span style="font-size: 1.5rem;">ğŸ“„</span>
      {% else %}
        <span style="font-size: 1.5rem;">ğŸ”—</span>
      {% endif %}
      <div>
        <h4>{{ r.title }}</h4>
        <p class="muted">
          <span style="color: var(--accent); font-weight: 600;">{{ r.subject }}</span> â€¢ 
          {{ r.exam or ('Grade ' ~ r.grade) }} â€¢ 
          <span style="padding: 4px 8px; background: rgba(99, 102, 241, 0.2); border-radius: 6px; font-size: 0.85rem;">
            {{ r.difficulty|capitalize }}
          </span>
          {% if r.resource_type %}
          <span style="padding: 4px 8px; background: rgba(16, 185, 129, 0.2); border-radius: 6px; font-size: 0.85rem; margin-left: 4px;">
            {{ r.resource_type|upper }}
          </span>
          {% endif %}
        </p>
      </div>
    </div>
    <div class="actions">
      {% if r.resource_type == 'youtube' %}
        <a class="btn outline" href="{{ r.url }}" target="_blank">â–¶ï¸ Watch Video</a>
      {% elif r.resource_type == 'pdf' %}
        <a class="btn outline" href="{{ r.url }}" target="_blank">ğŸ“„ View PDF</a>
      {% else %}
        <a class="btn outline" href="{{ r.url }}" target="_blank">ğŸ”— Open</a>
      {% endif %}
      <form method="post" action="{{ url_for('track') }}" onsubmit="return tracked(this);" style="margin: 0;">
        <input type="hidden" name="kind" value="resource">
        <input type="hidden" name="ref_id" value="{{ r.id }}">
        <button class="btn" type="submit">âœ… Mark Done</button>
      </form>
    </div>
  </div>
  {% else %}
  <div class="empty-state">
    <p>No resources found. Try adjusting your filters.</p>
  </div>
  {% endfor %}
</div>
{% endblock %}